<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Watch Along â€” FPL Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg:      #070b14;
      --surface: #0d1220;
      --card:    #111827;
      --card2:   #162033;
      --border:  #1a2840;
      --accent:  #00d4aa;
      --blue:    #3b82f6;
      --amber:   #f59e0b;
      --danger:  #ef4444;
      --purple:  #a855f7;
      --green:   #22c55e;
      --text:    #e2e8f0;
      --muted:   #4a5f7a;
      --font-h:  'Bebas Neue', sans-serif;
      --font-b:  'DM Sans', sans-serif;
      --font-m:  'JetBrains Mono', monospace;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-b);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* subtle grid bg */
    body::before {
      content: '';
      position: fixed; inset: 0; pointer-events: none; z-index: 0;
      background-image:
        linear-gradient(rgba(0,212,170,0.02) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,212,170,0.02) 1px, transparent 1px);
      background-size: 48px 48px;
    }

    /* â”€â”€ Navbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    nav {
      position: sticky; top: 0; z-index: 200;
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 1.5rem; height: 58px;
      background: rgba(7,11,20,0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border);
    }
    .nav-logo { font-family: var(--font-h); font-size: 1.5rem; color: var(--accent); text-decoration: none; letter-spacing: 2px; }
    .nav-logo span { color: var(--text); }
    .nav-links { display: flex; gap: 0.2rem; list-style: none; }
    .nav-links a {
      padding: 0.35rem 0.8rem; border-radius: 6px; text-decoration: none;
      font-size: 0.8rem; font-weight: 600; color: var(--muted); transition: all 0.2s;
    }
    .nav-links a:hover  { color: var(--text); background: var(--card); }
    .nav-links a.active { color: var(--amber); background: rgba(245,158,11,0.1); }

    /* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .layout {
      display: grid;
      grid-template-columns: 1fr 360px;
      grid-template-rows: auto 1fr;
      gap: 0;
      height: calc(100vh - 58px);
      position: relative;
      z-index: 1;
    }

    /* â”€â”€ LEFT COLUMN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .left-col {
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      border-right: 1px solid var(--border);
    }

    /* â”€â”€ RIGHT COLUMN (Chat) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .right-col {
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* â”€â”€ MATCH HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .match-header {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 1.5rem;
      position: relative;
      overflow: hidden;
    }
    .match-header::before {
      content: 'âš½';
      position: absolute; right: -1rem; top: 50%;
      transform: translateY(-50%);
      font-size: 8rem; opacity: 0.03; pointer-events: none;
    }

    .match-meta {
      display: flex; align-items: center; gap: 1rem;
      margin-bottom: 1.25rem; flex-wrap: wrap;
    }
    .match-gw-badge {
      font-family: var(--font-m); font-size: 0.65rem; letter-spacing: 2px;
      padding: 0.25rem 0.75rem; border-radius: 20px;
      background: rgba(245,158,11,0.12); border: 1px solid rgba(245,158,11,0.25);
      color: var(--amber);
    }
    .match-competition {
      font-family: var(--font-m); font-size: 0.65rem; color: var(--muted); letter-spacing: 1px;
    }
    .live-indicator {
      display: flex; align-items: center; gap: 5px;
      font-family: var(--font-m); font-size: 0.65rem; letter-spacing: 1px;
      color: var(--danger); margin-left: auto;
    }
    .live-dot { width: 7px; height: 7px; border-radius: 50%; background: var(--danger); animation: pulse 1s infinite; }

    /* â”€â”€ TEAMS DISPLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .teams-display {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      gap: 1.5rem;
    }

    .team-block { display: flex; flex-direction: column; align-items: center; gap: 0.75rem; }
    .team-block.away { }

    /* Team Logo */
    .team-logo-wrap {
      position: relative;
    }
    .team-logo {
      width: 88px; height: 88px;
      border-radius: 50%;
      background: var(--card);
      border: 2px solid var(--border);
      display: flex; align-items: center; justify-content: center;
      font-size: 3rem;
      position: relative;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .team-logo:hover { transform: scale(1.05); }
    .team-logo.scored {
      animation: goalPulse 0.6s ease;
      box-shadow: 0 0 30px rgba(245,158,11,0.5);
    }
    .team-logo-img {
      width: 88px; height: 88px;
      border-radius: 50%; object-fit: contain;
      border: 2px solid var(--border);
    }
    .team-name-big {
      font-family: var(--font-h); font-size: 1.5rem; letter-spacing: 2px;
      text-align: center; line-height: 1;
    }
    .team-record {
      font-family: var(--font-m); font-size: 0.6rem; color: var(--muted); letter-spacing: 1px;
    }

    /* â”€â”€ SCORE CENTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .score-center { text-align: center; }
    .scoreboard {
      display: flex; align-items: center; gap: 0;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }
    .score-num {
      font-family: var(--font-h);
      font-size: 3.5rem;
      letter-spacing: 2px;
      line-height: 1;
      padding: 0.5rem 1.25rem;
      min-width: 80px;
      text-align: center;
      transition: color 0.3s;
    }
    .score-num.home { color: var(--accent); }
    .score-num.away { color: var(--blue); }
    .score-sep-line {
      width: 1px; height: 60px; background: var(--border);
    }
    .match-status {
      font-family: var(--font-m); font-size: 0.7rem; letter-spacing: 2px;
      color: var(--amber); display: block; margin-top: 0.25rem;
    }
    .match-minute {
      font-family: var(--font-h); font-size: 1.2rem; color: var(--danger); letter-spacing: 1px;
    }

    /* â”€â”€ COUNTDOWN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .countdown-section {
      text-align: center; padding: 1rem 0 0;
    }
    .countdown-label {
      font-family: var(--font-m); font-size: 0.6rem; color: var(--muted); letter-spacing: 2px; margin-bottom: 0.5rem;
    }
    .countdown-display {
      display: flex; align-items: center; justify-content: center; gap: 0.5rem;
    }
    .cd-block {
      background: var(--card2); border: 1px solid var(--border);
      border-radius: 8px; padding: 0.5rem 0.75rem; min-width: 56px; text-align: center;
    }
    .cd-val { font-family: var(--font-h); font-size: 1.8rem; letter-spacing: 2px; color: var(--amber); line-height: 1; }
    .cd-unit { font-family: var(--font-m); font-size: 0.55rem; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; }
    .cd-colon { font-family: var(--font-h); font-size: 1.5rem; color: var(--muted); animation: pulse 1s infinite; }

    /* â”€â”€ GOALS LOG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .goals-section {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--border);
    }
    .goals-header {
      display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.75rem;
    }
    .section-label {
      font-family: var(--font-m); font-size: 0.62rem; letter-spacing: 2px; color: var(--muted); text-transform: uppercase;
    }
    .goals-grid {
      display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;
    }
    .goal-item {
      display: flex; align-items: center; gap: 0.5rem;
      background: var(--card2); border: 1px solid var(--border);
      border-radius: 8px; padding: 0.5rem 0.75rem;
      animation: goalSlide 0.4s ease;
    }
    .goal-item.home-goal { border-left: 3px solid var(--accent); }
    .goal-item.away-goal { border-left: 3px solid var(--blue); }
    .goal-min { font-family: var(--font-m); font-size: 0.65rem; color: var(--amber); flex-shrink: 0; }
    .goal-name { font-size: 0.8rem; font-weight: 600; }
    .goal-type { font-size: 0.6rem; color: var(--muted); }
    .goal-icon { font-size: 0.9rem; margin-left: auto; }
    .no-goals { text-align: center; color: var(--muted); font-size: 0.8rem; padding: 0.75rem; font-style: italic; }

    /* â”€â”€ ADMIN CONTROLS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .admin-section {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--border);
    }
    .admin-toggle {
      font-family: var(--font-m); font-size: 0.65rem; letter-spacing: 1px;
      padding: 0.3rem 0.8rem; border-radius: 6px;
      border: 1px solid var(--border); background: transparent;
      color: var(--muted); cursor: pointer; transition: all 0.2s;
    }
    .admin-toggle:hover { border-color: var(--amber); color: var(--amber); }
    .admin-panel {
      display: none; margin-top: 1rem;
    }
    .admin-panel.open { display: block; }
    .admin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .admin-box {
      background: var(--card2); border: 1px solid var(--border);
      border-radius: 10px; padding: 1rem;
    }
    .admin-box-title { font-size: 0.7rem; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.75rem; }
    .admin-row { display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap; margin-bottom: 0.5rem; }
    .admin-input {
      background: var(--card); border: 1px solid var(--border);
      border-radius: 6px; padding: 0.4rem 0.7rem;
      color: var(--text); font-family: var(--font-m); font-size: 0.75rem;
      outline: none; transition: border-color 0.2s; flex: 1; min-width: 80px;
    }
    .admin-input:focus { border-color: var(--accent); }
    .admin-btn {
      font-family: var(--font-m); font-size: 0.65rem; letter-spacing: 1px;
      padding: 0.4rem 0.9rem; border-radius: 6px; border: none;
      cursor: pointer; transition: all 0.2s; white-space: nowrap; font-weight: 700;
    }
    .admin-btn.green  { background: rgba(0,212,170,0.15); color: var(--accent); border: 1px solid rgba(0,212,170,0.3); }
    .admin-btn.green:hover  { background: var(--accent); color: #000; }
    .admin-btn.blue   { background: rgba(59,130,246,0.15); color: var(--blue); border: 1px solid rgba(59,130,246,0.3); }
    .admin-btn.blue:hover   { background: var(--blue);   color: #fff; }
    .admin-btn.amber  { background: rgba(245,158,11,0.15); color: var(--amber); border: 1px solid rgba(245,158,11,0.3); }
    .admin-btn.amber:hover  { background: var(--amber);  color: #000; }
    .admin-btn.danger { background: rgba(239,68,68,0.15); color: var(--danger); border: 1px solid rgba(239,68,68,0.3); }
    .admin-btn.danger:hover { background: var(--danger); color: #fff; }

    .score-ctrl { display: flex; align-items: center; gap: 0.5rem; }
    .score-ctrl-num {
      font-family: var(--font-h); font-size: 1.5rem; letter-spacing: 1px;
      width: 36px; text-align: center;
    }
    .score-ctrl-btn {
      width: 30px; height: 30px; border-radius: 6px; border: none;
      font-size: 1rem; cursor: pointer; transition: all 0.15s;
      display: flex; align-items: center; justify-content: center;
    }
    .score-ctrl-btn.plus  { background: rgba(0,212,170,0.15); color: var(--accent); }
    .score-ctrl-btn.minus { background: rgba(239,68,68,0.15);  color: var(--danger); }
    .score-ctrl-btn:hover { transform: scale(1.1); }

    /* â”€â”€ POLL SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .poll-section {
      padding: 1rem 1.5rem;
    }
    .poll-card {
      background: var(--card2); border: 1px solid var(--border);
      border-radius: 14px; overflow: hidden;
    }
    .poll-head {
      padding: 1rem 1.25rem; border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
    }
    .poll-question-txt {
      font-size: 0.95rem; font-weight: 600; line-height: 1.3; flex: 1;
    }
    .poll-total { font-family: var(--font-m); font-size: 0.65rem; color: var(--muted); white-space: nowrap; margin-left: 1rem; }
    .poll-options { padding: 0.75rem 1.25rem; display: flex; flex-direction: column; gap: 0.6rem; }
    .poll-option {
      position: relative; cursor: pointer;
      border-radius: 8px; overflow: hidden;
      border: 1px solid var(--border);
      transition: border-color 0.2s;
    }
    .poll-option:hover { border-color: var(--purple); }
    .poll-option.voted { border-color: var(--purple); }
    .poll-option-bar {
      position: absolute; top: 0; left: 0; bottom: 0;
      background: rgba(168,85,247,0.12);
      transition: width 0.8s cubic-bezier(.4,0,.2,1);
      border-right: 2px solid rgba(168,85,247,0.3);
    }
    .poll-option-bar.leading { background: rgba(0,212,170,0.1); border-right-color: rgba(0,212,170,0.3); }
    .poll-option-content {
      position: relative; display: flex; align-items: center;
      padding: 0.6rem 1rem; gap: 0.75rem; z-index: 1;
    }
    .poll-option-text { font-size: 0.85rem; font-weight: 600; flex: 1; }
    .poll-option-pct  { font-family: var(--font-m); font-size: 0.75rem; font-weight: 700; color: var(--purple); }
    .poll-option.leading .poll-option-pct { color: var(--accent); }
    .poll-option-votes { font-family: var(--font-m); font-size: 0.6rem; color: var(--muted); }
    .poll-voted-check { color: var(--accent); font-size: 0.8rem; }

    .poll-footer { padding: 0.75rem 1.25rem; border-top: 1px solid var(--border); display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .poll-input {
      background: var(--card); border: 1px solid var(--border);
      border-radius: 6px; padding: 0.35rem 0.75rem;
      color: var(--text); font-family: var(--font-b); font-size: 0.8rem;
      outline: none; flex: 1; min-width: 120px;
    }
    .poll-input:focus { border-color: var(--purple); }
    .poll-set-btn {
      font-family: var(--font-m); font-size: 0.65rem; letter-spacing: 1px;
      padding: 0.4rem 1rem; border-radius: 6px; border: none;
      background: rgba(168,85,247,0.15); color: var(--purple);
      border: 1px solid rgba(168,85,247,0.3); cursor: pointer;
      transition: all 0.2s; font-weight: 700;
    }
    .poll-set-btn:hover { background: var(--purple); color: #fff; }

    /* â”€â”€ RIGHT COL: CHAT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .chat-header {
      padding: 1rem 1.25rem;
      border-bottom: 1px solid var(--border);
      background: var(--surface);
      flex-shrink: 0;
    }
    .chat-header-top {
      display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.75rem;
    }
    .chat-title {
      font-family: var(--font-h); font-size: 1.4rem; letter-spacing: 2px;
    }
    .yt-input-wrap { display: flex; gap: 0.5rem; }
    .yt-input {
      background: var(--card); border: 1px solid var(--border);
      border-radius: 6px; padding: 0.4rem 0.75rem;
      color: var(--text); font-family: var(--font-m); font-size: 0.72rem;
      outline: none; flex: 1; min-width: 0;
      transition: border-color 0.2s;
    }
    .yt-input:focus { border-color: var(--danger); }
    .yt-input::placeholder { color: var(--muted); }
    .yt-btn {
      font-family: var(--font-m); font-size: 0.65rem; letter-spacing: 1px;
      padding: 0.4rem 0.8rem; border-radius: 6px; border: none;
      background: var(--danger); color: white; cursor: pointer;
      font-weight: 700; transition: all 0.2s; white-space: nowrap;
    }
    .yt-btn:hover { background: #ff6b6b; }

    /* YouTube Chat Embed */
    .yt-chat-frame {
      flex: 1;
      background: var(--card);
      border: none;
      width: 100%;
      display: block;
    }
    .yt-chat-placeholder {
      flex: 1;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      gap: 0.75rem; color: var(--muted);
      background: var(--card);
      padding: 2rem; text-align: center;
    }
    .yt-logo { font-size: 3rem; opacity: 0.3; }
    .yt-ph-title { font-family: var(--font-h); font-size: 1.2rem; letter-spacing: 2px; }
    .yt-ph-sub { font-size: 0.8rem; line-height: 1.6; }
    .yt-ph-sub code {
      font-family: var(--font-m); font-size: 0.7rem;
      background: var(--card2); padding: 1px 5px; border-radius: 3px;
      color: var(--accent);
    }

    /* â”€â”€ GOAL CELEBRATION OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .goal-celebration {
      position: fixed; inset: 0; z-index: 999;
      display: flex; align-items: center; justify-content: center;
      pointer-events: none; opacity: 0;
      transition: opacity 0.3s;
    }
    .goal-celebration.show { opacity: 1; }
    .goal-celebration-inner {
      text-align: center;
      animation: goalBounce 0.5s ease;
    }
    .goal-big { font-family: var(--font-h); font-size: 8rem; letter-spacing: 8px; line-height: 1;
      text-shadow: 0 0 40px rgba(245,158,11,0.8), 0 0 80px rgba(245,158,11,0.4);
      color: var(--amber);
    }
    .goal-scorer-big { font-family: var(--font-h); font-size: 2rem; letter-spacing: 4px; color: white;
      text-shadow: 0 2px 20px rgba(0,0,0,0.8);
    }

    /* â”€â”€ Animations â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }
    @keyframes goalPulse { 0%{box-shadow:0 0 0 rgba(245,158,11,0)} 50%{box-shadow:0 0 40px rgba(245,158,11,0.6)} 100%{box-shadow:0 0 0 rgba(245,158,11,0)} }
    @keyframes goalSlide { from{opacity:0;transform:translateY(-8px)} to{opacity:1;transform:translateY(0)} }
    @keyframes goalBounce { 0%{transform:scale(0.5);opacity:0} 70%{transform:scale(1.1)} 100%{transform:scale(1);opacity:1} }
    @keyframes confettiFall {
      0%   { transform: translateY(-10px) rotate(0deg);   opacity: 1; }
      100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
    }

    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

    /* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 900px) {
      .layout { grid-template-columns: 1fr; grid-template-rows: auto auto; height: auto; }
      .right-col { height: 500px; border-top: 1px solid var(--border); }
      .left-col  { overflow-y: visible; }
      .admin-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<!-- â”€â”€ Goal Celebration Overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="goal-celebration" id="goalCelebration">
  <div class="goal-celebration-inner">
    <div class="goal-big">GOAL!</div>
    <div class="goal-scorer-big" id="celebScorer"></div>
  </div>
</div>

<!-- â”€â”€ Navbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<nav>
  <a href="../index.html" class="nav-logo">FPL<span>HUB</span></a>
  <ul class="nav-links">
    <li><a href="../index.html">ğŸ  Home</a></li>
    <li><a href="fantasy.html">âš¡ Fantasy</a></li>
    <li><a href="predictions.html">ğŸ¯ Predict</a></li>
    <li><a href="watchalong.html" class="active">ğŸ“º Watch Along</a></li>
    <li><a href="../overlay.html" target="_blank">ğŸ® OBS</a></li>
  </ul>
</nav>

<!-- â”€â”€ Main Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="layout">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LEFT COLUMN
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="left-col">

    <!-- MATCH HEADER -->
    <div class="match-header">
      <div class="match-meta">
        <span class="match-gw-badge" id="gwBadge">GW 28</span>
        <span class="match-competition">Premier League 2024/25</span>
        <div class="live-indicator" id="liveIndicator" style="display:none">
          <span class="live-dot"></span> LIVE
        </div>
      </div>

      <!-- TEAMS + SCORE -->
      <div class="teams-display">

        <!-- Home Team -->
        <div class="team-block home">
          <div class="team-logo-wrap">
            <div class="team-logo" id="homeLogo">
              <span id="homeEmoji">ğŸ”´</span>
            </div>
          </div>
          <div class="team-name-big" id="homeNameDisplay">HOME</div>
          <div class="team-record" id="homeRecord">â€”</div>
        </div>

        <!-- Score Center -->
        <div class="score-center">
          <div class="scoreboard">
            <div class="score-num home" id="homeScoreDisplay">0</div>
            <div class="score-sep-line"></div>
            <div class="score-num away" id="awayScoreDisplay">0</div>
          </div>

          <!-- Status: Countdown OR Live minute OR FT -->
          <div id="matchStatusWrap">
            <!-- Countdown (pre-match) -->
            <div id="countdownSection" class="countdown-section">
              <div class="countdown-label">KICK OFF IN</div>
              <div class="countdown-display">
                <div class="cd-block"><div class="cd-val" id="cd-h">00</div><div class="cd-unit">HRS</div></div>
                <div class="cd-colon">:</div>
                <div class="cd-block"><div class="cd-val" id="cd-m">00</div><div class="cd-unit">MIN</div></div>
                <div class="cd-colon">:</div>
                <div class="cd-block"><div class="cd-val" id="cd-s">00</div><div class="cd-unit">SEC</div></div>
              </div>
            </div>

            <!-- Live minute -->
            <div id="liveMinuteSection" style="display:none; text-align:center; padding:0.5rem 0">
              <div class="match-minute" id="liveMinute">1'</div>
              <span class="match-status">LIVE</span>
            </div>

            <!-- FT -->
            <div id="ftSection" style="display:none; text-align:center; padding:0.5rem 0">
              <span class="match-status" style="font-size:1.1rem;color:var(--muted)">FULL TIME</span>
            </div>
          </div>
        </div>

        <!-- Away Team -->
        <div class="team-block away">
          <div class="team-logo-wrap">
            <div class="team-logo" id="awayLogo">
              <span id="awayEmoji">ğŸ”µ</span>
            </div>
          </div>
          <div class="team-name-big" id="awayNameDisplay">AWAY</div>
          <div class="team-record" id="awayRecord">â€”</div>
        </div>

      </div><!-- /teams-display -->
    </div><!-- /match-header -->

    <!-- GOALS LOG -->
    <div class="goals-section">
      <div class="goals-header">
        <span class="section-label">âš½ Goals</span>
        <span style="font-family:var(--font-m);font-size:0.6rem;color:var(--muted)" id="goalCount">0 goals</span>
      </div>
      <div class="goals-grid" id="goalsGrid">
        <div class="no-goals" style="grid-column:1/-1">No goals yet â€” match not started</div>
      </div>
    </div>

    <!-- ADMIN CONTROLS -->
    <div class="admin-section">
      <div style="display:flex;align-items:center;gap:0.75rem;margin-bottom:0">
        <span class="section-label">âš™ï¸ Match Controls</span>
        <button class="admin-toggle" onclick="toggleAdmin()">SHOW / HIDE</button>
        <span style="font-family:var(--font-m);font-size:0.6rem;color:var(--muted)">
          (update match info here)
        </span>
      </div>

      <div class="admin-panel" id="adminPanel">
        <div class="admin-grid" style="margin-top:0.75rem">

          <!-- Team Setup -->
          <div class="admin-box">
            <div class="admin-box-title">Team Setup</div>
            <div class="admin-row">
              <input class="admin-input" id="inp-homeTeam" placeholder="Home Team" value="Arsenal" />
              <input class="admin-input" id="inp-homeEmoji" placeholder="ğŸ”´" value="ğŸ”´" style="max-width:52px;" />
            </div>
            <div class="admin-row">
              <input class="admin-input" id="inp-awayTeam" placeholder="Away Team" value="Man City" />
              <input class="admin-input" id="inp-awayEmoji" placeholder="ğŸ”µ" value="ğŸ”µ" style="max-width:52px;" />
            </div>
            <div class="admin-row">
              <input class="admin-input" id="inp-gw" placeholder="GW" value="28" style="max-width:60px;" />
              <input class="admin-input" id="inp-kickoff" type="datetime-local" />
              <button class="admin-btn green" onclick="applyTeams()">APPLY</button>
            </div>
          </div>

          <!-- Score Control -->
          <div class="admin-box">
            <div class="admin-box-title">Score Control</div>
            <div style="display:flex;gap:1rem;margin-bottom:0.75rem">
              <div>
                <div style="font-size:0.6rem;color:var(--muted);margin-bottom:4px;" id="homeCtrlLabel">HOME</div>
                <div class="score-ctrl">
                  <button class="score-ctrl-btn minus" onclick="adjustScore('home',-1)">âˆ’</button>
                  <div class="score-ctrl-num" id="homeCtrlNum">0</div>
                  <button class="score-ctrl-btn plus" onclick="adjustScore('home',1)">+</button>
                </div>
              </div>
              <div>
                <div style="font-size:0.6rem;color:var(--muted);margin-bottom:4px;" id="awayCtrlLabel">AWAY</div>
                <div class="score-ctrl">
                  <button class="score-ctrl-btn minus" onclick="adjustScore('away',-1)">âˆ’</button>
                  <div class="score-ctrl-num" id="awayCtrlNum">0</div>
                  <button class="score-ctrl-btn plus" onclick="adjustScore('away',1)">+</button>
                </div>
              </div>
            </div>
            <div class="admin-row">
              <input class="admin-input" id="inp-scorer" placeholder="Scorer name" />
              <input class="admin-input" id="inp-minute" placeholder="Min" style="max-width:55px;" />
              <select class="admin-input" id="inp-goalType" style="max-width:80px;">
                <option value="âš½">Goal</option>
                <option value="ğŸ…¿ï¸">Penalty</option>
                <option value="ğŸ™ƒ">OG</option>
              </select>
            </div>
          </div>

          <!-- Match State -->
          <div class="admin-box" style="grid-column:1/-1">
            <div class="admin-box-title">Match State</div>
            <div class="admin-row" style="flex-wrap:wrap">
              <button class="admin-btn amber" onclick="setMatchState('pre')">â° PRE-MATCH</button>
              <button class="admin-btn green" onclick="setMatchState('live')">â–¶ LIVE</button>
              <button class="admin-btn blue" onclick="setMatchState('ht')">â˜• HALF TIME</button>
              <button class="admin-btn danger" onclick="setMatchState('ft')">ğŸ FULL TIME</button>
              <input class="admin-input" id="inp-minute-live" placeholder="Minute (live)" style="max-width:100px" />
              <button class="admin-btn green" onclick="updateMinute()">SET MIN</button>
              <button class="admin-btn danger" onclick="resetMatch()">â†º RESET</button>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- POLL SECTION -->
    <div class="poll-section">
      <div style="margin-bottom:0.75rem">
        <div class="section-label">ğŸ“Š Live Poll</div>
      </div>
      <div class="poll-card">
        <div class="poll-head">
          <div class="poll-question-txt" id="pollQuestion">Who will score the first goal?</div>
          <div class="poll-total" id="pollTotal">0 votes</div>
        </div>
        <div class="poll-options" id="pollOptions"></div>
        <div class="poll-footer">
          <input class="poll-input" id="pollQInput" placeholder="New poll questionâ€¦" />
          <input class="poll-input" id="pollOpt1" placeholder="Option 1" value="Home" style="max-width:100px" />
          <input class="poll-input" id="pollOpt2" placeholder="Option 2" value="Away" style="max-width:100px" />
          <input class="poll-input" id="pollOpt3" placeholder="Option 3" value="No Goal" style="max-width:100px" />
          <button class="poll-set-btn" onclick="resetPoll()">NEW POLL</button>
        </div>
      </div>
    </div>

  </div><!-- /left-col -->

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RIGHT COLUMN â€” YouTube Chat
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="right-col">
    <div class="chat-header">
      <div class="chat-header-top">
        <div class="chat-title">ğŸ’¬ LIVE CHAT</div>
        <div style="font-family:var(--font-m);font-size:0.6rem;color:var(--muted)">YouTube Chat</div>
      </div>
      <div class="yt-input-wrap">
        <input
          class="yt-input"
          id="ytVideoId"
          placeholder="YouTube Video ID (e.g. dQw4w9WgXcQ)"
        />
        <button class="yt-btn" onclick="loadYTChat()">LOAD â–¶</button>
      </div>
    </div>

    <!-- Chat area: placeholder or iframe -->
    <div id="chatArea" style="flex:1;display:flex;flex-direction:column;overflow:hidden">
      <div class="yt-chat-placeholder" id="ytPlaceholder">
        <div class="yt-logo">â–¶</div>
        <div class="yt-ph-title">YOUTUBE LIVE CHAT</div>
        <p class="yt-ph-sub">
          Enter your YouTube Live Video ID above and click Load.<br><br>
          Find it in your stream URL:<br>
          <code>youtube.com/watch?v=<strong>VIDEO_ID</strong></code><br><br>
          Chat will appear here in real-time during your stream.
        </p>
      </div>
      <iframe
        id="ytChatFrame"
        class="yt-chat-frame"
        style="display:none;flex:1;"
        allow="autoplay; clipboard-write; encrypted-media"
        allowfullscreen
      ></iframe>
    </div>
  </div>

</div><!-- /layout -->

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const MATCH_KEY = 'fpl_watchalong_match';
const POLL_KEY  = 'fpl_poll_results';

let state = JSON.parse(localStorage.getItem(MATCH_KEY) || 'null') || {
  homeTeam:  'Arsenal',
  awayTeam:  'Man City',
  homeEmoji: 'ğŸ”´',
  awayEmoji: 'ğŸ”µ',
  homeScore: 0,
  awayScore: 0,
  gw:        28,
  kickoff:   null,   // ISO string
  matchState:'pre',  // pre | live | ht | ft
  liveMinute: 0,
  goals:     [],
};

let pollState = JSON.parse(localStorage.getItem(POLL_KEY) || 'null') || {
  question: 'Who will score the first goal?',
  options:  ['Home', 'Away', 'No Goal'],
  votes:    [0, 0, 0],
  myVote:   null,
};

let liveTimer    = null;
let countdownInt = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SAVE STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveState() {
  localStorage.setItem(MATCH_KEY, JSON.stringify(state));
  localStorage.setItem(POLL_KEY,  JSON.stringify(pollState));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RENDER MATCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderMatch() {
  // Teams
  document.getElementById('homeNameDisplay').textContent = state.homeTeam;
  document.getElementById('awayNameDisplay').textContent = state.awayTeam;
  document.getElementById('homeEmoji').textContent       = state.homeEmoji;
  document.getElementById('awayEmoji').textContent       = state.awayEmoji;
  document.getElementById('gwBadge').textContent         = `GW ${state.gw}`;

  // Score
  document.getElementById('homeScoreDisplay').textContent = state.homeScore;
  document.getElementById('awayScoreDisplay').textContent = state.awayScore;
  document.getElementById('homeCtrlNum').textContent      = state.homeScore;
  document.getElementById('awayCtrlNum').textContent      = state.awayScore;
  document.getElementById('homeCtrlLabel').textContent    = state.homeTeam.toUpperCase().slice(0,8);
  document.getElementById('awayCtrlLabel').textContent    = state.awayTeam.toUpperCase().slice(0,8);

  // State sections
  const pre  = document.getElementById('countdownSection');
  const live = document.getElementById('liveMinuteSection');
  const ft   = document.getElementById('ftSection');
  const liveInd = document.getElementById('liveIndicator');

  pre.style.display  = 'none';
  live.style.display = 'none';
  ft.style.display   = 'none';
  liveInd.style.display = 'none';

  if (state.matchState === 'pre') {
    pre.style.display = 'block';
    startCountdown();
  } else if (state.matchState === 'live') {
    live.style.display = 'block';
    liveInd.style.display = 'flex';
    document.getElementById('liveMinute').textContent = state.liveMinute + "'";
    startLiveTimer();
  } else if (state.matchState === 'ht') {
    live.style.display = 'block';
    document.getElementById('liveMinute').textContent = 'HT';
    document.getElementById('liveMinute').style.color = 'var(--amber)';
  } else if (state.matchState === 'ft') {
    ft.style.display = 'block';
  }

  // Goals
  renderGoals();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  GOALS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderGoals() {
  const grid = document.getElementById('goalsGrid');
  const goals = state.goals;

  document.getElementById('goalCount').textContent = goals.length + (goals.length === 1 ? ' goal' : ' goals');

  if (!goals.length) {
    grid.innerHTML = `<div class="no-goals" style="grid-column:1/-1">No goals yet</div>`;
    return;
  }

  // Split home/away
  const homeGoals = goals.filter(g => g.team === 'home');
  const awayGoals = goals.filter(g => g.team === 'away');
  const maxLen    = Math.max(homeGoals.length, awayGoals.length);

  let html = '';
  for (let i = 0; i < maxLen; i++) {
    // Home goal cell
    if (homeGoals[i]) {
      const g = homeGoals[i];
      html += `<div class="goal-item home-goal">
        <span class="goal-min">${g.minute}'</span>
        <div><div class="goal-name">${g.scorer}</div><div class="goal-type">${g.typeLabel || 'Goal'}</div></div>
        <span class="goal-icon">${g.type}</span>
      </div>`;
    } else {
      html += `<div></div>`;
    }
    // Away goal cell
    if (awayGoals[i]) {
      const g = awayGoals[i];
      html += `<div class="goal-item away-goal">
        <span class="goal-min">${g.minute}'</span>
        <div><div class="goal-name">${g.scorer}</div><div class="goal-type">${g.typeLabel || 'Goal'}</div></div>
        <span class="goal-icon">${g.type}</span>
      </div>`;
    } else {
      html += `<div></div>`;
    }
  }
  grid.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ADJUST SCORE + ADD GOAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function adjustScore(team, delta) {
  if (team === 'home') {
    state.homeScore = Math.max(0, state.homeScore + delta);
    document.getElementById('homeCtrlNum').textContent = state.homeScore;
  } else {
    state.awayScore = Math.max(0, state.awayScore + delta);
    document.getElementById('awayCtrlNum').textContent = state.awayScore;
  }

  // If adding a goal (+1), record it
  if (delta === 1) {
    const scorer  = document.getElementById('inp-scorer').value.trim() || 'Unknown';
    const minute  = document.getElementById('inp-minute').value.trim()
                    || state.liveMinute || '?';
    const typeEl  = document.getElementById('inp-goalType');
    const typeIcon = typeEl.value;
    const typeLabel = typeEl.options[typeEl.selectedIndex].text;

    const goal = { team, scorer, minute, type: typeIcon, typeLabel, ts: Date.now() };
    state.goals.push(goal);

    // Celebration
    showGoalCelebration(scorer, team);
  }

  document.getElementById('homeScoreDisplay').textContent = state.homeScore;
  document.getElementById('awayScoreDisplay').textContent = state.awayScore;
  renderGoals();
  saveState();

  // Logo pulse
  const logoId = team === 'home' ? 'homeLogo' : 'awayLogo';
  const logo = document.getElementById(logoId);
  logo.classList.add('scored');
  setTimeout(() => logo.classList.remove('scored'), 800);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  GOAL CELEBRATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showGoalCelebration(scorer, team) {
  const el     = document.getElementById('goalCelebration');
  const teamName = team === 'home' ? state.homeTeam : state.awayTeam;
  document.getElementById('celebScorer').textContent = scorer + ' Â· ' + teamName;
  el.classList.add('show');
  spawnConfetti();
  setTimeout(() => el.classList.remove('show'), 3000);
}

function spawnConfetti() {
  const colors = ['#00d4aa','#f59e0b','#3b82f6','#ef4444','#a855f7','#ffffff'];
  for (let i = 0; i < 60; i++) {
    const el = document.createElement('div');
    el.style.cssText = `
      position:fixed; top:-10px; left:${Math.random()*100}vw;
      width:${6+Math.random()*6}px; height:${6+Math.random()*6}px;
      background:${colors[Math.floor(Math.random()*colors.length)]};
      border-radius:${Math.random()>0.5?'50%':'2px'};
      z-index:998; pointer-events:none;
      animation: confettiFall ${1.5+Math.random()*2}s ease forwards;
      animation-delay:${Math.random()*0.5}s;
    `;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 3500);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MATCH STATE CONTROL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setMatchState(s) {
  clearInterval(liveTimer);
  clearInterval(countdownInt);

  state.matchState = s;
  if (s === 'live' && state.liveMinute === 0) state.liveMinute = 1;
  renderMatch();
  saveState();
}

function updateMinute() {
  const m = parseInt(document.getElementById('inp-minute-live').value);
  if (!isNaN(m)) { state.liveMinute = m; renderMatch(); saveState(); }
}

function startLiveTimer() {
  clearInterval(liveTimer);
  liveTimer = setInterval(() => {
    if (state.matchState === 'live') {
      state.liveMinute++;
      document.getElementById('liveMinute').textContent = state.liveMinute + "'";
      if (state.liveMinute % 5 === 0) saveState();
    }
  }, 60000); // real minute
}

function resetMatch() {
  if (!confirm('Reset match to default?')) return;
  state = {
    homeTeam:'Arsenal', awayTeam:'Man City',
    homeEmoji:'ğŸ”´', awayEmoji:'ğŸ”µ',
    homeScore:0, awayScore:0,
    gw:28, kickoff:null, matchState:'pre', liveMinute:0, goals:[],
  };
  renderMatch();
  saveState();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  APPLY TEAMS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function applyTeams() {
  state.homeTeam  = document.getElementById('inp-homeTeam').value  || state.homeTeam;
  state.awayTeam  = document.getElementById('inp-awayTeam').value  || state.awayTeam;
  state.homeEmoji = document.getElementById('inp-homeEmoji').value || state.homeEmoji;
  state.awayEmoji = document.getElementById('inp-awayEmoji').value || state.awayEmoji;
  state.gw        = parseInt(document.getElementById('inp-gw').value) || state.gw;
  const ko        = document.getElementById('inp-kickoff').value;
  if (ko) {
    state.kickoff = new Date(ko).toISOString();
    localStorage.setItem('fpl_kickoff', state.kickoff);
  }
  renderMatch();
  saveState();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  COUNTDOWN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startCountdown() {
  clearInterval(countdownInt);
  if (!state.kickoff) return;

  function tick() {
    const diff = new Date(state.kickoff).getTime() - Date.now();
    if (diff <= 0) {
      clearInterval(countdownInt);
      ['cd-h','cd-m','cd-s'].forEach(id => document.getElementById(id).textContent = '00');
      return;
    }
    const h = Math.floor(diff / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);
    document.getElementById('cd-h').textContent = String(h).padStart(2,'0');
    document.getElementById('cd-m').textContent = String(m).padStart(2,'0');
    document.getElementById('cd-s').textContent = String(s).padStart(2,'0');
  }
  tick();
  countdownInt = setInterval(tick, 1000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ADMIN TOGGLE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleAdmin() {
  document.getElementById('adminPanel').classList.toggle('open');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  POLL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderPoll() {
  const p      = pollState;
  const total  = p.votes.reduce((a,b) => a+b, 0);
  const maxV   = Math.max(...p.votes);

  document.getElementById('pollQuestion').textContent = p.question;
  document.getElementById('pollTotal').textContent    = total + ' votes';

  const container = document.getElementById('pollOptions');
  container.innerHTML = p.options.map((opt, i) => {
    const pct     = total > 0 ? Math.round(p.votes[i] / total * 100) : 0;
    const leading = p.votes[i] === maxV && maxV > 0;
    const voted   = p.myVote === i;
    return `
      <div class="poll-option ${leading ? 'leading' : ''} ${voted ? 'voted' : ''}"
           onclick="vote(${i})">
        <div class="poll-option-bar ${leading ? 'leading' : ''}" style="width:${pct}%"></div>
        <div class="poll-option-content">
          <span class="poll-option-text">${opt}</span>
          ${voted ? '<span class="poll-voted-check">âœ“</span>' : ''}
          <span class="poll-option-votes">${p.votes[i]}</span>
          <span class="poll-option-pct">${pct}%</span>
        </div>
      </div>`;
  }).join('');
}

function vote(idx) {
  if (pollState.myVote !== null) {
    // Allow changing vote
    pollState.votes[pollState.myVote] = Math.max(0, pollState.votes[pollState.myVote] - 1);
  }
  pollState.myVote = idx;
  pollState.votes[idx]++;
  saveState();
  renderPoll();
}

function resetPoll() {
  const q    = document.getElementById('pollQInput').value.trim();
  const o1   = document.getElementById('pollOpt1').value.trim();
  const o2   = document.getElementById('pollOpt2').value.trim();
  const o3   = document.getElementById('pollOpt3').value.trim();
  pollState  = {
    question: q || 'Who will score the next goal?',
    options:  [o1||'Home', o2||'Away', o3||'Draw'],
    votes:    [0, 0, 0],
    myVote:   null,
  };
  saveState();
  renderPoll();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  YOUTUBE CHAT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadYTChat() {
  const vid = document.getElementById('ytVideoId').value.trim();
  if (!vid) return;

  // Extract ID if full URL pasted
  const match = vid.match(/(?:v=|youtu\.be\/|\/live\/)([a-zA-Z0-9_-]{11})/);
  const videoId = match ? match[1] : vid;

  localStorage.setItem('fpl_yt_video', videoId);
  document.getElementById('ytVideoId').value = videoId;

  const frame = document.getElementById('ytChatFrame');
  const ph    = document.getElementById('ytPlaceholder');

  frame.src = `https://www.youtube.com/live_chat?v=${videoId}&embed_domain=${location.hostname || 'localhost'}`;
  frame.style.display = 'block';
  ph.style.display    = 'none';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function init() {
  // Restore inputs
  document.getElementById('inp-homeTeam').value  = state.homeTeam;
  document.getElementById('inp-awayTeam').value  = state.awayTeam;
  document.getElementById('inp-homeEmoji').value = state.homeEmoji;
  document.getElementById('inp-awayEmoji').value = state.awayEmoji;
  document.getElementById('inp-gw').value        = state.gw;

  renderMatch();
  renderPoll();

  // Restore YT video
  const savedVid = localStorage.getItem('fpl_yt_video');
  if (savedVid) {
    document.getElementById('ytVideoId').value = savedVid;
    // Auto-load only if was live before
    if (state.matchState === 'live' || state.matchState === 'ht') {
      loadYTChat();
    }
  }

  // Poll refresh every 5s (in case another tab updates)
  setInterval(() => {
    const fresh = JSON.parse(localStorage.getItem(POLL_KEY) || 'null');
    if (fresh && JSON.stringify(fresh) !== JSON.stringify(pollState)) {
      pollState = fresh;
      renderPoll();
    }
  }, 5000);
}

init();
</script>
</body>
</html>
