<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Watch Along ‚Äî FPL Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    :root{
      --bg:#070b14;--s1:#0d1220;--s2:#111827;--s3:#162033;
      --bd:#1a2840;--ac:#00d4aa;--bl:#3b82f6;--am:#f59e0b;
      --dg:#ef4444;--pu:#a855f7;--gn:#22c55e;
      --tx:#e2e8f0;--mt:#4a5f7a;
      --fh:'Bebas Neue',sans-serif;
      --fb:'DM Sans',sans-serif;
      --fm:'JetBrains Mono',monospace;
    }
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html{scroll-behavior:smooth}
    body{background:var(--bg);color:var(--tx);font-family:var(--fb);min-height:100vh;overflow-x:hidden}
    body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
      background-image:linear-gradient(rgba(0,212,170,.018) 1px,transparent 1px),linear-gradient(90deg,rgba(0,212,170,.018) 1px,transparent 1px);
      background-size:52px 52px}

    /* NAV */
    nav{position:sticky;top:0;z-index:200;display:flex;align-items:center;justify-content:space-between;
      padding:.75rem 2rem;background:rgba(7,11,20,.92);border-bottom:1px solid var(--bd);backdrop-filter:blur(16px)}
    .brand{font-family:var(--fh);font-size:1.5rem;letter-spacing:3px;color:var(--ac);text-decoration:none}
    .brand span{color:var(--tx)}
    .nav-links{display:flex;gap:.25rem}
    .nav-links a{font-family:var(--fm);font-size:.62rem;letter-spacing:1.5px;padding:.35rem .85rem;border-radius:7px;
      color:var(--mt);text-decoration:none;transition:all .2s}
    .nav-links a:hover{color:var(--tx);background:rgba(255,255,255,.05)}
    .nav-links a.active{color:var(--ac);background:rgba(0,212,170,.1);border:1px solid rgba(0,212,170,.2)}

    main{position:relative;z-index:1;max-width:1400px;margin:0 auto;padding:2rem}

    /* PAGE HEADER */
    .page-hdr{text-align:center;margin-bottom:2.5rem}
    .page-hdr .lbl{font-family:var(--fm);font-size:.62rem;color:var(--mt);letter-spacing:3px;margin-bottom:.5rem}
    .page-hdr h1{font-family:var(--fh);font-size:3.5rem;letter-spacing:4px;line-height:1;
      background:linear-gradient(135deg,var(--ac),var(--bl));-webkit-background-clip:text;-webkit-text-fill-color:transparent}

    /* MAIN GRID */
    .main-grid{display:grid;grid-template-columns:1fr 380px;gap:1.5rem;align-items:start}

    /* ‚îÄ‚îÄ VIDEO SECTION ‚îÄ‚îÄ */
    .video-section{display:flex;flex-direction:column;gap:1.25rem}
    .video-wrap{position:relative;background:var(--s1);border:1px solid var(--bd);border-radius:16px;overflow:hidden;
      aspect-ratio:16/9}
    .video-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;
      height:100%;gap:1rem;color:var(--mt)}
    .video-placeholder .icon{font-size:3.5rem;opacity:.4}
    .video-placeholder .txt{font-family:var(--fm);font-size:.7rem;letter-spacing:2px;opacity:.5}
    .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%;border:none}
    .video-id-row{display:flex;gap:.5rem;align-items:center}
    .video-inp{flex:1;background:var(--s2);border:1px solid var(--bd);border-radius:8px;
      padding:.5rem 1rem;color:var(--tx);font-family:var(--fm);font-size:.72rem;outline:none;transition:border-color .2s}
    .video-inp:focus{border-color:var(--ac)}
    .video-inp::placeholder{color:var(--mt)}
    .vid-btn{font-family:var(--fm);font-size:.62rem;letter-spacing:1px;padding:.5rem 1rem;border-radius:8px;border:none;
      background:rgba(0,212,170,.15);color:var(--ac);border:1px solid rgba(0,212,170,.25);cursor:pointer;transition:all .2s;white-space:nowrap}
    .vid-btn:hover{background:var(--ac);color:#000}

    /* ‚îÄ‚îÄ MATCH CARD ‚îÄ‚îÄ */
    .match-card{background:var(--s1);border:1px solid var(--bd);border-radius:16px;overflow:hidden}
    .match-card-hdr{padding:1rem 1.5rem;border-bottom:1px solid var(--bd);display:flex;align-items:center;justify-content:space-between}
    .mc-title{font-family:var(--fh);font-size:1rem;letter-spacing:2px;color:var(--ac)}
    .mc-comp{font-family:var(--fm);font-size:.58rem;color:var(--mt);letter-spacing:1px}

    /* TEAMS ROW */
    .teams-row{padding:1.5rem;display:flex;align-items:center;justify-content:space-between;gap:1rem}
    .team-side{display:flex;flex-direction:column;align-items:center;gap:.6rem;flex:1}
    .team-badge-wrap{width:72px;height:72px;display:flex;align-items:center;justify-content:center;
      background:var(--s2);border:1px solid var(--bd);border-radius:12px;overflow:hidden}
    .team-badge-wrap img{width:60px;height:60px;object-fit:contain}
    .team-name{font-family:var(--fh);font-size:1.1rem;letter-spacing:1px;text-align:center}
    .team-short{font-family:var(--fm);font-size:.55rem;color:var(--mt);letter-spacing:2px}

    /* SCORE CENTER */
    .score-center{display:flex;flex-direction:column;align-items:center;gap:.5rem;flex-shrink:0}
    .scoreboard{display:flex;align-items:center;background:var(--s2);border:1px solid var(--bd);border-radius:12px;overflow:hidden}
    .sn{font-family:var(--fh);font-size:3rem;letter-spacing:2px;padding:.1rem .8rem;min-width:56px;text-align:center}
    .sn.h{color:var(--ac)}.sn.a{color:var(--bl)}
    .sdiv{width:1px;height:52px;background:var(--bd)}
    .state-badge{font-family:var(--fm);font-size:.6rem;padding:.25rem .75rem;border-radius:20px;letter-spacing:1px;font-weight:700}
    .state-badge.pre{background:rgba(255,255,255,.06);color:var(--mt);border:1px solid var(--bd)}
    .state-badge.live{background:rgba(239,68,68,.15);color:var(--dg);border:1px solid rgba(239,68,68,.3);animation:pulse 2s infinite}
    .state-badge.ht{background:rgba(245,158,11,.12);color:var(--am);border:1px solid rgba(245,158,11,.25)}
    .state-badge.ft{background:rgba(0,212,170,.1);color:var(--ac);border:1px solid rgba(0,212,170,.2)}
    .match-time{font-family:var(--fm);font-size:.65rem;color:rgba(255,255,255,.3);letter-spacing:1px}

    /* MATCH META */
    .match-meta{display:grid;grid-template-columns:1fr 1fr 1fr;gap:.75rem;padding:0 1.5rem 1.25rem}
    .mm-item{background:var(--s2);border:1px solid var(--bd);border-radius:8px;padding:.6rem .75rem;text-align:center}
    .mm-val{font-family:var(--fh);font-size:.95rem;letter-spacing:1px;color:var(--ac)}
    .mm-key{font-family:var(--fm);font-size:.5rem;color:var(--mt);letter-spacing:1.5px;text-transform:uppercase;margin-top:2px}

    /* MATCH CONTROLS */
    .match-controls{padding:1rem 1.5rem;border-top:1px solid var(--bd);display:flex;flex-direction:column;gap:.75rem}
    .ctrl-row{display:flex;gap:.5rem;align-items:center}
    .ctrl-lbl{font-family:var(--fm);font-size:.58rem;color:var(--mt);letter-spacing:1px;width:70px;flex-shrink:0}
    .ctrl-inp{flex:1;background:var(--s2);border:1px solid var(--bd);border-radius:7px;
      padding:.38rem .65rem;color:var(--tx);font-family:var(--fm);font-size:.72rem;outline:none;transition:border-color .2s}
    .ctrl-inp:focus{border-color:var(--ac)}
    .ctrl-inp::placeholder{color:var(--mt);font-size:.65rem}
    select.ctrl-inp{cursor:pointer}
    .sc-row{display:flex;align-items:center;justify-content:center;gap:.5rem}
    .sc-btn{width:32px;height:32px;border-radius:7px;border:none;cursor:pointer;font-size:1.1rem;
      display:flex;align-items:center;justify-content:center;transition:all .15s;font-weight:700}
    .sc-btn.p{background:rgba(0,212,170,.15);color:var(--ac)}.sc-btn.p:hover{background:var(--ac);color:#000}
    .sc-btn.m{background:rgba(239,68,68,.15);color:var(--dg)}.sc-btn.m:hover{background:var(--dg);color:#fff}
    .sc-num{font-family:var(--fh);font-size:2.2rem;min-width:36px;text-align:center;line-height:1}
    .state-btns{display:flex;gap:.4rem;flex-wrap:wrap}
    .sb{font-family:var(--fm);font-size:.6rem;letter-spacing:1px;padding:.38rem .75rem;border-radius:7px;
      border:none;cursor:pointer;transition:all .2s;font-weight:700}
    .sb.a{background:rgba(245,158,11,.15);color:var(--am);border:1px solid rgba(245,158,11,.25)}.sb.a:hover{background:var(--am);color:#000}
    .sb.g{background:rgba(239,68,68,.15);color:var(--dg);border:1px solid rgba(239,68,68,.25)}.sb.g:hover{background:var(--dg);color:#fff}
    .sb.b{background:rgba(59,130,246,.15);color:var(--bl);border:1px solid rgba(59,130,246,.25)}.sb.b:hover{background:var(--bl);color:#fff}
    .sb.c{background:rgba(0,212,170,.15);color:var(--ac);border:1px solid rgba(0,212,170,.25)}.sb.c:hover{background:var(--ac);color:#000}
    .apply-btn{width:100%;font-family:var(--fm);font-size:.65rem;letter-spacing:2px;padding:.55rem;border-radius:8px;border:none;
      background:rgba(0,212,170,.15);color:var(--ac);border:1px solid rgba(0,212,170,.25);cursor:pointer;transition:all .2s}
    .apply-btn:hover{background:var(--ac);color:#000}

    /* RIGHT PANEL */
    .right-panel{display:flex;flex-direction:column;gap:1.25rem}

    /* COUNTDOWN */
    .countdown-card{background:var(--s1);border:1px solid var(--bd);border-radius:16px;padding:1.5rem;text-align:center}
    .cd-lbl{font-family:var(--fm);font-size:.6rem;color:var(--mt);letter-spacing:3px;margin-bottom:.75rem}
    .cd-time{font-family:var(--fh);font-size:3rem;letter-spacing:4px;color:var(--am);line-height:1}
    .cd-units{display:flex;justify-content:center;gap:1.5rem;margin-top:.4rem}
    .cd-unit{font-family:var(--fm);font-size:.52rem;color:var(--mt);letter-spacing:1px}
    .cd-live{font-family:var(--fh);font-size:1.8rem;letter-spacing:3px;color:var(--dg);animation:pulse 1.5s infinite}
    .kickoff-inp-row{display:flex;gap:.5rem;margin-top:1rem}

    /* LINEUP */
    .lineup-card{background:var(--s1);border:1px solid var(--bd);border-radius:16px;overflow:hidden}
    .lc-hdr{padding:.85rem 1.25rem;border-bottom:1px solid var(--bd);display:flex;align-items:center;justify-content:space-between}
    .lc-title{font-family:var(--fh);font-size:.95rem;letter-spacing:2px;color:var(--ac)}
    .lc-tabs{display:flex;gap:.3rem}
    .lc-tab{font-family:var(--fm);font-size:.58rem;padding:.25rem .65rem;border-radius:5px;border:none;cursor:pointer;transition:all .2s;letter-spacing:1px}
    .lc-tab.active{background:var(--ac);color:#000;font-weight:700}
    .lc-tab:not(.active){background:var(--s2);color:var(--mt);border:1px solid var(--bd)}
    .lc-tab:not(.active):hover{border-color:var(--ac);color:var(--ac)}

    .lineup-body{padding:1rem 1.25rem}
    .formation-lbl{font-family:var(--fm);font-size:.58rem;color:var(--mt);letter-spacing:2px;margin-bottom:.75rem;text-align:center}
    .formation-inp-row{display:flex;gap:.4rem;margin-bottom:.75rem}

    /* PITCH */
    .pitch{background:linear-gradient(180deg,#0a3d1f 0%,#0d4a25 50%,#0a3d1f 100%);
      border-radius:10px;padding:1rem .75rem;position:relative;border:1px solid rgba(255,255,255,.06)}
    .pitch::before{content:'';position:absolute;top:50%;left:10%;right:10%;height:1px;background:rgba(255,255,255,.08)}
    .pitch::after{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
      width:60px;height:60px;border-radius:50%;border:1px solid rgba(255,255,255,.08)}
    .pitch-row{display:flex;justify-content:center;gap:.4rem;margin-bottom:.6rem}
    .pitch-row:last-child{margin-bottom:0}
    .player-btn{display:flex;flex-direction:column;align-items:center;gap:2px;cursor:pointer;min-width:52px}
    .player-shirt{width:32px;height:32px;border-radius:6px;display:flex;align-items:center;justify-content:center;
      font-family:var(--fh);font-size:.75rem;border:1px solid rgba(255,255,255,.15);transition:all .2s;position:relative}
    .player-shirt:hover{transform:scale(1.1)}
    .player-shirt .num{position:absolute;top:-5px;right:-5px;width:14px;height:14px;border-radius:50%;
      background:var(--am);color:#000;font-family:var(--fm);font-size:.45rem;display:flex;align-items:center;justify-content:center;font-weight:700}
    .player-shirt.cap .num{background:var(--ac)}
    .player-name{font-family:var(--fm);font-size:.48rem;color:rgba(255,255,255,.7);text-align:center;
      letter-spacing:.5px;max-width:52px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .player-shirt.scored::after{content:'‚öΩ';position:absolute;bottom:-6px;left:50%;transform:translateX(-50%);font-size:.55rem}
    .player-shirt.carded::after{content:'üü®';position:absolute;bottom:-6px;left:50%;transform:translateX(-50%);font-size:.55rem}
    .player-shirt.red::after{content:'üü•';position:absolute;bottom:-6px;left:50%;transform:translateX(-50%);font-size:.55rem}

    .subs-section{margin-top:.75rem;padding-top:.75rem;border-top:1px solid rgba(255,255,255,.06)}
    .subs-lbl{font-family:var(--fm);font-size:.52rem;color:var(--mt);letter-spacing:2px;margin-bottom:.5rem;text-align:center}
    .subs-row{display:flex;justify-content:center;gap:.4rem;flex-wrap:wrap}

    /* LINEUP EDIT MODAL */
    .lineup-edit{padding:.75rem 1.25rem;border-top:1px solid var(--bd)}
    .le-grid{display:grid;grid-template-columns:1fr 1fr;gap:.4rem;max-height:220px;overflow-y:auto}
    .le-item{display:flex;align-items:center;gap:.4rem;background:var(--s2);border-radius:6px;padding:.3rem .5rem}
    .le-num{font-family:var(--fh);font-size:.75rem;color:var(--am);width:20px;text-align:center;flex-shrink:0}
    .le-inp{flex:1;background:transparent;border:none;outline:none;color:var(--tx);font-family:var(--fb);font-size:.68rem}
    .le-inp::placeholder{color:var(--mt);font-size:.62rem}

    /* EVENTS */
    .events-card{background:var(--s1);border:1px solid var(--bd);border-radius:16px;overflow:hidden}
    .ev-hdr{padding:.85rem 1.25rem;border-bottom:1px solid var(--bd);display:flex;align-items:center;justify-content:space-between}
    .ev-title{font-family:var(--fh);font-size:.95rem;letter-spacing:2px;color:var(--ac)}
    .ev-add{font-family:var(--fm);font-size:.58rem;padding:.25rem .65rem;border-radius:5px;border:1px solid var(--bd);
      background:transparent;color:var(--mt);cursor:pointer;transition:all .2s;letter-spacing:1px}
    .ev-add:hover{border-color:var(--ac);color:var(--ac)}
    .ev-body{padding:.75rem 1.25rem;max-height:200px;overflow-y:auto}
    .ev-item{display:flex;align-items:center;gap:.6rem;padding:.4rem 0;border-bottom:1px solid rgba(255,255,255,.04)}
    .ev-item:last-child{border-bottom:none}
    .ev-min{font-family:var(--fh);font-size:.95rem;color:var(--am);min-width:36px}
    .ev-icon{font-size:.85rem;flex-shrink:0}
    .ev-player{font-size:.78rem;font-weight:600;flex:1}
    .ev-team{font-family:var(--fm);font-size:.52rem;color:var(--mt)}
    .ev-del{font-family:var(--fm);font-size:.55rem;padding:.15rem .4rem;border-radius:4px;border:none;
      background:rgba(239,68,68,.1);color:var(--dg);cursor:pointer;opacity:.5;transition:opacity .2s}
    .ev-del:hover{opacity:1}
    .ev-empty{text-align:center;padding:1rem;font-family:var(--fm);font-size:.62rem;color:var(--mt);letter-spacing:1px}
    .ev-form{display:flex;gap:.4rem;padding:.75rem 1.25rem;border-top:1px solid var(--bd);flex-wrap:wrap}
    .ev-form input,
    .ev-form select{flex:1;min-width:80px;background:var(--s2);border:1px solid var(--bd);border-radius:6px;
      padding:.35rem .6rem;color:var(--tx);font-family:var(--fm);font-size:.65rem;outline:none}
    .ev-form input:focus,
    .ev-form select:focus{border-color:var(--ac)}
    .ev-form button{font-family:var(--fm);font-size:.62rem;padding:.35rem .75rem;border-radius:6px;border:none;
      background:rgba(0,212,170,.15);color:var(--ac);border:1px solid rgba(0,212,170,.25);cursor:pointer;transition:all .2s}
    .ev-form button:hover{background:var(--ac);color:#000}

    /* TOAST */
    #toast{position:fixed;bottom:2rem;right:2rem;z-index:999;font-family:var(--fm);font-size:.7rem;
      padding:.5rem 1.2rem;border-radius:8px;background:var(--ac);color:#000;font-weight:700;
      opacity:0;transition:opacity .3s;pointer-events:none;letter-spacing:1px}

    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.35}}
    @keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
    .fade-in{animation:fadeIn .4s ease forwards}

    /* RESPONSIVE */
    @media(max-width:900px){
      .main-grid{grid-template-columns:1fr}
      .right-panel{order:-1}
    }
  </style>
</head>
<body>

<nav>
  <a class="brand" href="../index.html">FPL<span>HUB</span></a>
  <div class="nav-links">
    <a href="../index.html">üè† Home</a>
    <a href="fantasy.html">‚ö° Fantasy</a>
    <a href="predictions.html">üéØ Predict</a>
    <a href="watchalong.html" class="active">üì∫ Watch Along</a>
    <a href="../overlay.html">üéÆ OBS</a>
  </div>
</nav>

<main>
  <div class="page-hdr fade-in">
    <div class="lbl">// LIVE MATCH</div>
    <h1>WATCH ALONG</h1>
  </div>

  <div class="main-grid">

    <!-- LEFT: VIDEO + MATCH -->
    <div class="video-section">

      <!-- VIDEO FRAME -->
      <div class="video-wrap" id="videoWrap">
        <div class="video-placeholder" id="videoPlaceholder">
          <div class="icon">‚ñ∂</div>
          <div class="txt">YouTube VIDEO ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´</div>
        </div>
      </div>
      <div class="video-id-row">
        <input class="video-inp" id="ytInp" placeholder="YouTube Video ID (e.g. dQw4w9WgXcQ)"/>
        <button class="vid-btn" onclick="loadVideo()">‚ñ∂ LOAD</button>
        <button class="vid-btn" style="background:rgba(239,68,68,.1);color:var(--dg);border-color:rgba(239,68,68,.25)" onclick="clearVideo()">‚úï</button>
      </div>

      <!-- MATCH CARD -->
      <div class="match-card fade-in">
        <div class="match-card-hdr">
          <div class="mc-title">‚öΩ MATCH INFO</div>
          <div class="mc-comp" id="compLbl">PREMIER LEAGUE</div>
        </div>

        <!-- TEAMS + SCORE -->
        <div class="teams-row">
          <div class="team-side">
            <div class="team-badge-wrap" id="homeBadgeWrap">
              <img id="homeBadge" src="" alt="" style="display:none" onerror="this.style.display='none'"/>
              <span id="homeBadgeFb" style="font-size:1.5rem">üè†</span>
            </div>
            <div class="team-name" id="homeNameDisp">HOME</div>
            <div class="team-short" id="homeShortDisp">HOM</div>
          </div>

          <div class="score-center">
            <div class="scoreboard">
              <div class="sn h" id="scoreH">0</div>
              <div class="sdiv"></div>
              <div class="sn a" id="scoreA">0</div>
            </div>
            <div class="state-badge pre" id="stateBadge">PRE-MATCH</div>
            <div class="match-time" id="matchTimeLbl">--:-- KO</div>
          </div>

          <div class="team-side">
            <div class="team-badge-wrap" id="awayBadgeWrap">
              <img id="awayBadge" src="" alt="" style="display:none" onerror="this.style.display='none'"/>
              <span id="awayBadgeFb" style="font-size:1.5rem">‚úàÔ∏è</span>
            </div>
            <div class="team-name" id="awayNameDisp">AWAY</div>
            <div class="team-short" id="awayShortDisp">AWY</div>
          </div>
        </div>

        <!-- META -->
        <div class="match-meta">
          <div class="mm-item">
            <div class="mm-val" id="metaStadium">‚Äî</div>
            <div class="mm-key">STADIUM</div>
          </div>
          <div class="mm-item">
            <div class="mm-val" id="metaKO">‚Äî</div>
            <div class="mm-key">KICK OFF</div>
          </div>
          <div class="mm-item">
            <div class="mm-val" id="metaGW">‚Äî</div>
            <div class="mm-key">GAMEWEEK</div>
          </div>
        </div>

        <!-- CONTROLS -->
        <div class="match-controls">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem">
            <div class="ctrl-row"><span class="ctrl-lbl">HOME</span><input class="ctrl-inp" id="inpHome" placeholder="Arsenal" oninput="updateTeamName('home')"/></div>
            <div class="ctrl-row"><span class="ctrl-lbl">HOME ID</span><input class="ctrl-inp" id="inpHomeId" placeholder="1 (FPL ID)" type="number" oninput="updateBadge('home')"/></div>
            <div class="ctrl-row"><span class="ctrl-lbl">AWAY</span><input class="ctrl-inp" id="inpAway" placeholder="Man City" oninput="updateTeamName('away')"/></div>
            <div class="ctrl-row"><span class="ctrl-lbl">AWAY ID</span><input class="ctrl-inp" id="inpAwayId" placeholder="13 (FPL ID)" type="number" oninput="updateBadge('away')"/></div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:.5rem">
            <div class="ctrl-row"><span class="ctrl-lbl">STADIUM</span><input class="ctrl-inp" id="inpStadium" placeholder="Emirates"/></div>
            <div class="ctrl-row"><span class="ctrl-lbl">GW</span><input class="ctrl-inp" id="inpGW" placeholder="28" type="number"/></div>
            <div class="ctrl-row"><span class="ctrl-lbl">COMP</span><input class="ctrl-inp" id="inpComp" placeholder="PREMIER LEAGUE"/></div>
          </div>
          <div class="ctrl-row"><span class="ctrl-lbl">KICK OFF</span><input class="ctrl-inp" id="inpKO" type="datetime-local"/></div>

          <!-- SCORE CONTROL -->
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:.75rem">
            <div>
              <div style="font-family:var(--fm);font-size:.55rem;color:var(--mt);text-align:center;margin-bottom:.3rem" id="homeScoreLbl">HOME</div>
              <div class="sc-row">
                <button class="sc-btn m" onclick="adj('h',-1)">‚àí</button>
                <div class="sc-num" id="ctrlH">0</div>
                <button class="sc-btn p" onclick="adj('h',1)">+</button>
              </div>
            </div>
            <div>
              <div style="font-family:var(--fm);font-size:.55rem;color:var(--mt);text-align:center;margin-bottom:.3rem" id="awayScoreLbl">AWAY</div>
              <div class="sc-row">
                <button class="sc-btn m" onclick="adj('a',-1)">‚àí</button>
                <div class="sc-num" id="ctrlA">0</div>
                <button class="sc-btn p" onclick="adj('a',1)">+</button>
              </div>
            </div>
          </div>

          <div>
            <div style="font-family:var(--fm);font-size:.55rem;color:var(--mt);letter-spacing:1px;margin-bottom:.4rem">MATCH STATE</div>
            <div class="state-btns">
              <button class="sb a" onclick="setState('pre')">PRE</button>
              <button class="sb g" onclick="setState('live')">‚ñ∂ LIVE</button>
              <button class="sb b" onclick="setState('ht')">HALF TIME</button>
              <button class="sb c" onclick="setState('ft')">FULL TIME</button>
            </div>
          </div>
          <button class="apply-btn" onclick="applyAll()">‚úì APPLY ALL</button>
        </div>
      </div>
    </div>

    <!-- RIGHT PANEL -->
    <div class="right-panel">

      <!-- COUNTDOWN -->
      <div class="countdown-card fade-in">
        <div class="cd-lbl">‚è± KICK OFF IN</div>
        <div id="cdDisplay">
          <div class="cd-time" id="cdTime">--:--:--</div>
          <div class="cd-units">
            <span class="cd-unit">HRS</span>
            <span class="cd-unit">MIN</span>
            <span class="cd-unit">SEC</span>
          </div>
        </div>
      </div>

      <!-- LINEUP -->
      <div class="lineup-card fade-in">
        <div class="lc-hdr">
          <div class="lc-title">üë• LINEUPS</div>
          <div class="lc-tabs">
            <button class="lc-tab active" id="tab-home" onclick="switchLineup('home')">HOME</button>
            <button class="lc-tab" id="tab-away" onclick="switchLineup('away')">AWAY</button>
          </div>
        </div>

        <div class="lineup-body">
          <div class="formation-lbl" id="formationLbl">Formation: 4-3-3</div>
          <div class="formation-inp-row">
            <input class="ctrl-inp" id="formInp" placeholder="4-3-3" style="flex:1" oninput="updateFormation()"/>
            <button class="vid-btn" onclick="renderPitch()">‚Ü∫ RENDER</button>
          </div>
          <div class="pitch" id="pitchWrap">
            <!-- rendered by JS -->
          </div>
          <div class="subs-section">
            <div class="subs-lbl">SUBSTITUTES</div>
            <div class="subs-row" id="subsWrap"></div>
          </div>
        </div>

        <div class="lineup-edit">
          <div style="font-family:var(--fm);font-size:.58rem;color:var(--mt);letter-spacing:1px;margin-bottom:.5rem">EDIT PLAYERS</div>
          <div class="le-grid" id="leGrid"></div>
        </div>
      </div>

      <!-- EVENTS -->
      <div class="events-card fade-in">
        <div class="ev-hdr">
          <div class="ev-title">üìã MATCH EVENTS</div>
          <button class="ev-add" onclick="clearEvents()">‚úï CLEAR</button>
        </div>
        <div class="ev-body" id="evBody">
          <div class="ev-empty">No events yet</div>
        </div>
        <div class="ev-form">
          <input type="number" id="evMin" placeholder="Min" style="max-width:60px" min="1" max="120"/>
          <select id="evType">
            <option value="goal">‚öΩ Goal</option>
            <option value="assist">üÖ∞Ô∏è Assist</option>
            <option value="yellow">üü® Yellow</option>
            <option value="red">üü• Red</option>
            <option value="sub">üîÑ Sub</option>
            <option value="pen">üéØ Penalty</option>
            <option value="og">ü§¶ Own Goal</option>
          </select>
          <input type="text" id="evPlayer" placeholder="Player name" style="min-width:100px"/>
          <select id="evTeam">
            <option value="home">Home</option>
            <option value="away">Away</option>
          </select>
          <button onclick="addEvent()">+ ADD</button>
        </div>
      </div>

    </div>
  </div>
</main>

<div id="toast"></div>

<script>
// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
const STORE = 'fpl_watchalong';
let state = JSON.parse(localStorage.getItem(STORE)||'{}');

let match = state.match || {
  homeTeam:'', awayTeam:'', homeId:0, awayId:0,
  homeScore:0, awayScore:0, matchState:'pre',
  stadium:'', gw:'', comp:'PREMIER LEAGUE', kickoff:null
};
let events = state.events || [];
let lineups = state.lineups || {
  home:{formation:'4-3-3', players:Array(11).fill('').map((_,i)=>`Player ${i+1}`), subs:Array(4).fill('').map((_,i)=>`Sub ${i+1}`)},
  away:{formation:'4-3-3', players:Array(11).fill('').map((_,i)=>`Player ${i+1}`), subs:Array(4).fill('').map((_,i)=>`Sub ${i+1}`)}
};
let activeLineup = 'home';
let cdInterval;

// Badge URL
const BADGE_BASE = 'https://boexaw-ship-it.github.io/livingido-twmm/images/badges/';

// ‚îÄ‚îÄ SAVE ‚îÄ‚îÄ
function save(){
  localStorage.setItem(STORE, JSON.stringify({match, events, lineups}));
}

// ‚îÄ‚îÄ BADGE ‚îÄ‚îÄ
function updateBadge(side){
  const id = parseInt(document.getElementById(side==='home'?'inpHomeId':'inpAwayId').value)||0;
  const img = document.getElementById(side+'Badge');
  const fb  = document.getElementById(side+'BadgeFb');
  if(id){
    img.src = BADGE_BASE + id + '.png';
    img.style.display = 'block';
    fb.style.display = 'none';
    img.onerror = ()=>{ img.style.display='none'; fb.style.display='block'; };
  } else {
    img.style.display='none'; fb.style.display='block';
  }
  match[side==='home'?'homeId':'awayId']=id;
  save();
}

// ‚îÄ‚îÄ TEAM NAME ‚îÄ‚îÄ
function updateTeamName(side){
  const v = document.getElementById(side==='home'?'inpHome':'inpAway').value;
  document.getElementById(side+'NameDisp').textContent = v||side.toUpperCase();
  document.getElementById(side+'ShortDisp').textContent = (v||side).substring(0,3).toUpperCase();
  document.getElementById(side+'ScoreLbl').textContent = (v||side).toUpperCase().substring(0,8);
  // Update lineup tab label
  document.getElementById('tab-'+side).textContent = (v||(side==='home'?'HOME':'AWAY')).toUpperCase().substring(0,6);
  match[side==='home'?'homeTeam':'awayTeam']=v;
  save();
}

// ‚îÄ‚îÄ SCORE ‚îÄ‚îÄ
function adj(side, d){
  if(side==='h') match.homeScore = Math.max(0,(match.homeScore||0)+d);
  else match.awayScore = Math.max(0,(match.awayScore||0)+d);
  document.getElementById('score'+side.toUpperCase()).textContent = side==='h'?match.homeScore:match.awayScore;
  document.getElementById('ctrl'+side.toUpperCase()).textContent  = side==='h'?match.homeScore:match.awayScore;
  save();
}

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
function setState(s){
  match.matchState=s;
  const b=document.getElementById('stateBadge');
  b.className='state-badge '+s;
  const labels={pre:'PRE-MATCH',live:'‚óè LIVE',ht:'HALF TIME',ft:'FULL TIME'};
  b.textContent=labels[s]||s;
  toast(labels[s]);
  save();
}

// ‚îÄ‚îÄ APPLY ALL ‚îÄ‚îÄ
function applyAll(){
  match.homeTeam = document.getElementById('inpHome').value;
  match.awayTeam = document.getElementById('inpAway').value;
  match.homeId   = parseInt(document.getElementById('inpHomeId').value)||0;
  match.awayId   = parseInt(document.getElementById('inpAwayId').value)||0;
  match.stadium  = document.getElementById('inpStadium').value;
  match.gw       = document.getElementById('inpGW').value;
  match.comp     = document.getElementById('inpComp').value||'PREMIER LEAGUE';
  const ko       = document.getElementById('inpKO').value;
  match.kickoff  = ko ? new Date(ko).toISOString() : null;

  // Update display
  document.getElementById('homeNameDisp').textContent = match.homeTeam||'HOME';
  document.getElementById('awayNameDisp').textContent = match.awayTeam||'AWAY';
  document.getElementById('homeShortDisp').textContent = (match.homeTeam||'HOM').substring(0,3).toUpperCase();
  document.getElementById('awayShortDisp').textContent = (match.awayTeam||'AWY').substring(0,3).toUpperCase();
  document.getElementById('homeScoreLbl').textContent  = (match.homeTeam||'HOME').toUpperCase().substring(0,8);
  document.getElementById('awayScoreLbl').textContent  = (match.awayTeam||'AWAY').toUpperCase().substring(0,8);
  document.getElementById('metaStadium').textContent   = match.stadium||'‚Äî';
  document.getElementById('metaGW').textContent        = match.gw ? 'GW'+match.gw : '‚Äî';
  document.getElementById('compLbl').textContent       = match.comp;
  document.getElementById('tab-home').textContent      = (match.homeTeam||'HOME').substring(0,6).toUpperCase();
  document.getElementById('tab-away').textContent      = (match.awayTeam||'AWAY').substring(0,6).toUpperCase();

  // KO time display
  if(match.kickoff){
    const d=new Date(match.kickoff);
    document.getElementById('metaKO').textContent = d.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
    document.getElementById('matchTimeLbl').textContent = d.toLocaleDateString('en-GB',{weekday:'short',day:'numeric',month:'short'})+' ¬∑ '+d.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
    startCD();
  }
  updateBadge('home'); updateBadge('away');
  save(); toast('‚úì Applied!');
}

// ‚îÄ‚îÄ COUNTDOWN ‚îÄ‚îÄ
function startCD(){
  clearInterval(cdInterval);
  const ms = match.matchState==='live';
  if(!match.kickoff) return;
  function tick(){
    const diff = new Date(match.kickoff).getTime()-Date.now();
    const cdTime = document.getElementById('cdTime');
    const lbl = document.getElementById('cdDisplay');
    if(match.matchState==='live'){
      lbl.innerHTML='<div class="cd-live">‚óè LIVE NOW</div>';
      clearInterval(cdInterval);
      return;
    }
    if(match.matchState==='ft'){
      lbl.innerHTML='<div class="cd-live" style="color:var(--ac)">‚úì FULL TIME</div>';
      clearInterval(cdInterval);
      return;
    }
    if(match.matchState==='ht'){
      lbl.innerHTML='<div class="cd-live" style="color:var(--am)">‚è∏ HALF TIME</div>';
      clearInterval(cdInterval);
      return;
    }
    if(diff<=0){
      lbl.innerHTML='<div class="cd-live">‚óè KICK OFF!</div>';
      clearInterval(cdInterval);
      return;
    }
    const h=Math.floor(diff/3600000),m=Math.floor((diff%3600000)/60000),s=Math.floor((diff%60000)/1000);
    document.getElementById('cdTime').textContent=`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }
  tick(); cdInterval=setInterval(tick,1000);
}

// ‚îÄ‚îÄ VIDEO ‚îÄ‚îÄ
function loadVideo(){
  const raw = document.getElementById('ytInp').value.trim();
  if(!raw) return;
  // Extract ID from URL or use directly
  let id = raw;
  const m = raw.match(/(?:v=|youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})/);
  if(m) id=m[1];
  const wrap=document.getElementById('videoWrap');
  wrap.innerHTML=`<iframe src="https://www.youtube.com/embed/${id}?autoplay=0" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>`;
  save();
}
function clearVideo(){
  document.getElementById('videoWrap').innerHTML=`<div class="video-placeholder" id="videoPlaceholder"><div class="icon">‚ñ∂</div><div class="txt">YouTube VIDEO ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´</div></div>`;
  document.getElementById('ytInp').value='';
}

// ‚îÄ‚îÄ LINEUP ‚îÄ‚îÄ
function switchLineup(side){
  activeLineup=side;
  document.getElementById('tab-home').className='lc-tab'+(side==='home'?' active':'');
  document.getElementById('tab-away').className='lc-tab'+(side==='away'?' active':'');
  document.getElementById('formInp').value=lineups[side].formation||'4-3-3';
  document.getElementById('formationLbl').textContent='Formation: '+(lineups[side].formation||'4-3-3');
  renderPitch(); buildEditGrid();
}

function updateFormation(){
  const v=document.getElementById('formInp').value.trim();
  lineups[activeLineup].formation=v;
  document.getElementById('formationLbl').textContent='Formation: '+v;
  save();
}

function renderPitch(){
  const lu = lineups[activeLineup];
  const form = lu.formation||'4-3-3';
  const rows = form.split('-').map(Number);
  const players = lu.players||[];
  const teamColor = activeLineup==='home' ? '#00d4aa' : '#3b82f6';

  let idx=0;
  let html='';

  // GK row
  html+=`<div class="pitch-row">${playerChip(players[idx]||'GK', idx, teamColor, false)}</div>`;
  idx++;

  // Formation rows
  rows.forEach((n,ri)=>{
    html+='<div class="pitch-row">';
    for(let i=0;i<n;i++){
      const isCap = idx===0;
      html+=playerChip(players[idx]||'P'+(idx+1), idx, teamColor, idx===0);
      idx++;
    }
    html+='</div>';
  });

  document.getElementById('pitchWrap').innerHTML=html;

  // Subs
  const subs=lu.subs||[];
  document.getElementById('subsWrap').innerHTML=subs.map((s,i)=>`
    <div class="player-btn">
      <div class="player-shirt" style="background:${teamColor}22;color:${teamColor};font-size:.6rem">${(s||'SUB').substring(0,4)}</div>
      <div class="player-name">${s||'Sub '+(i+1)}</div>
    </div>`).join('');
}

function playerChip(name, idx, color, isCap){
  // Check events for this player
  const goals = events.filter(e=>e.type==='goal'&&e.player===name).length;
  const yellow= events.filter(e=>e.type==='yellow'&&e.player===name).length;
  const red   = events.filter(e=>e.type==='red'&&e.player===name).length;
  const extra = red?'red':yellow?'carded':goals?'scored':'';
  const short = name.split(' ').pop().substring(0,7);
  return `<div class="player-btn" onclick="quickEvent('${name}')">
    <div class="player-shirt ${extra}${isCap?' cap':''}" style="background:${color}22;color:${color}">
      ${short.substring(0,4)}
      ${isCap?'<span class="num">C</span>':''}
    </div>
    <div class="player-name">${name}</div>
  </div>`;
}

function buildEditGrid(){
  const lu=lineups[activeLineup];
  const all=[...lu.players,...lu.subs];
  document.getElementById('leGrid').innerHTML=all.map((p,i)=>`
    <div class="le-item">
      <div class="le-num">${i<11?i+1:'S'+(i-10)}</div>
      <input class="le-inp" value="${p}" placeholder="${i<11?'Player '+(i+1):'Sub '+(i-10)}"
        onchange="updatePlayer(${i},'${activeLineup}',this.value)"/>
    </div>`).join('');
}

function updatePlayer(idx, side, val){
  if(idx<11) lineups[side].players[idx]=val;
  else lineups[side].subs[idx-11]=val;
  save(); renderPitch();
}

function quickEvent(name){
  // Open event form with player prefilled
  document.getElementById('evPlayer').value=name;
  document.getElementById('evType').value='goal';
  const t=document.querySelector('.ev-form');
  t.style.background='rgba(0,212,170,.05)';
  setTimeout(()=>t.style.background='',600);
}

// ‚îÄ‚îÄ EVENTS ‚îÄ‚îÄ
const EV_ICONS={goal:'‚öΩ',assist:'üÖ∞Ô∏è',yellow:'üü®',red:'üü•',sub:'üîÑ',pen:'üéØ',og:'ü§¶'};
function addEvent(){
  const min=parseInt(document.getElementById('evMin').value)||0;
  const type=document.getElementById('evType').value;
  const player=document.getElementById('evPlayer').value.trim();
  const team=document.getElementById('evTeam').value;
  if(!player) return;
  events.push({min,type,player,team,id:Date.now()});
  events.sort((a,b)=>a.min-b.min);
  document.getElementById('evMin').value='';
  document.getElementById('evPlayer').value='';
  renderEvents(); renderPitch(); save(); toast('Event added!');
}
function clearEvents(){
  if(!confirm('Clear all events?')) return;
  events=[]; renderEvents(); renderPitch(); save();
}
function delEvent(id){
  events=events.filter(e=>e.id!==id); renderEvents(); renderPitch(); save();
}
function renderEvents(){
  const b=document.getElementById('evBody');
  if(!events.length){b.innerHTML='<div class="ev-empty">No events yet</div>';return;}
  b.innerHTML=events.map(e=>`
    <div class="ev-item">
      <span class="ev-min">${e.min}'</span>
      <span class="ev-icon">${EV_ICONS[e.type]||'‚Ä¢'}</span>
      <span class="ev-player">${e.player}</span>
      <span class="ev-team">${e.team==='home'?(match.homeTeam||'HOME'):(match.awayTeam||'AWAY')}</span>
      <button class="ev-del" onclick="delEvent(${e.id})">‚úï</button>
    </div>`).join('');
}

// ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ
function toast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg; t.style.opacity='1';
  clearTimeout(t._t); t._t=setTimeout(()=>t.style.opacity='0',2000);
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
function init(){
  // Restore inputs
  if(match.homeTeam) document.getElementById('inpHome').value=match.homeTeam;
  if(match.awayTeam) document.getElementById('inpAway').value=match.awayTeam;
  if(match.homeId)   document.getElementById('inpHomeId').value=match.homeId;
  if(match.awayId)   document.getElementById('inpAwayId').value=match.awayId;
  if(match.stadium)  document.getElementById('inpStadium').value=match.stadium;
  if(match.gw)       document.getElementById('inpGW').value=match.gw;
  if(match.comp)     document.getElementById('inpComp').value=match.comp;
  if(match.kickoff){
    const d=new Date(match.kickoff);
    document.getElementById('inpKO').value=new Date(d-d.getTimezoneOffset()*60000).toISOString().slice(0,16);
  }
  // Apply saved state to display
  if(match.homeTeam||match.awayTeam) applyAll();
  setState(match.matchState||'pre');
  renderEvents();
  switchLineup('home');
  startCD();
}

init();
</script>
</body>
</html>
